{"remainingRequest":"/Users/daocloud_j/git/loderunner-vue-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/daocloud_j/git/loderunner-vue-front/src/views/ProductList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/daocloud_j/git/loderunner-vue-front/src/views/ProductList.vue","mtime":1591819548000},{"path":"/Users/daocloud_j/git/loderunner-vue-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/daocloud_j/git/loderunner-vue-front/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/daocloud_j/git/loderunner-vue-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/daocloud_j/git/loderunner-vue-front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldFF1ZXJ5U3RyaW5nIH0gZnJvbSAnQC9jb21tb24vanMvdXRpbHMnCmltcG9ydCB7IHNlYXJjaCB9IGZyb20gJy4uL3NlcnZpY2UvZ29vZCcKaW1wb3J0IHsgVG9hc3QgfSBmcm9tICd2YW50JwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGtleXdvcmQ6IHRoaXMuJHJvdXRlLnF1ZXJ5LmtleXdvcmQgfHwgJycsCiAgICAgIHNlYXJjaEJ0bjogZmFsc2UsCiAgICAgIHNlY2xlY3RBY3RpdmU6IGZhbHNlLAogICAgICByZWZyZXNoaW5nOiBmYWxzZSwKICAgICAgbGlzdDogW10sCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBmaW5pc2hlZDogZmFsc2UsCiAgICAgIHByb2R1Y3RMaXN0OiBbXSwKICAgICAgdG90YWxQYWdlOiAwLAogICAgICBwYWdlOiAxLAogICAgICBvcmRlckJ5OiAnJwogICAgfQogIH0sCiAgbW91bnRlZCgpIHsKICAgIC8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLnBhZ2VTY3JvbGwpCiAgICAvLyBzZXRUaW1lb3V0KCgpID0+IHsKICAgIC8vICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlCiAgICAvLyB9LCA1MDApCiAgICAvLyB0aGlzLmluaXQoKQogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgaW5pdCgpIHsKICAgICAgY29uc3QgeyBjYXRlZ29yeUlkLCBmcm9tIH0gPSB0aGlzLiRyb3V0ZS5xdWVyeQogICAgICBpZiAoIWNhdGVnb3J5SWQgJiYgIXRoaXMua2V5d29yZCkgewogICAgICAgIC8vIFRvYXN0LmZhaWwoJ+ivt+i+k+WFpeWFs+mUruivjScpCiAgICAgICAgdGhpcy5maW5pc2hlZCA9IHRydWUKICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICByZXR1cm4KICAgICAgfQogICAgICBjb25zdCB7IGRhdGEsIGRhdGE6IHsgbGlzdCB9IH0gPSBhd2FpdCBzZWFyY2goeyBwYWdlTnVtYmVyOiB0aGlzLnBhZ2UsIGdvb2RzQ2F0ZWdvcnlJZDogY2F0ZWdvcnlJZCwga2V5d29yZDogdGhpcy5rZXl3b3JkLCBvcmRlckJ5OiB0aGlzLm9yZGVyQnkgfSkKICAgICAgdGhpcy5wcm9kdWN0TGlzdCA9IHRoaXMucHJvZHVjdExpc3QuY29uY2F0KGxpc3QpCiAgICAgIHRoaXMudG90YWxQYWdlID0gZGF0YS50b3RhbFBhZ2UKICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgIGlmICh0aGlzLnBhZ2UgPj0gZGF0YS50b3RhbFBhZ2UpIHRoaXMuZmluaXNoZWQgPSB0cnVlCiAgICB9LAogICAgZ29CYWNrKCkgewogICAgICB0aGlzLiRyb3V0ZXIuZ28oLTEpCiAgICB9LAogICAgcHJvZHVjdERldGFpbChpdGVtKSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgcGF0aDogYHByb2R1Y3QvJHtpdGVtLmdvb2RzSWR9YCB9KQogICAgfSwKICAgIHRleHRFbnRlcigpIHsKCiAgICB9LAogICAgdGV4dExlYXZlKCkgewoKICAgIH0sCiAgICBnZXRTZWFyY2goKSB7CiAgICAgIHRoaXMub25SZWZyZXNoKCkKICAgIH0sCiAgICBwYWdlU2Nyb2xsKCkgewogICAgICBsZXQgc2Nyb2xsVG9wID0gd2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgfHwgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AKICAgICAgc2Nyb2xsVG9wID4gNTAgPyB0aGlzLnNlY2xlY3RBY3RpdmUgPSB0cnVlIDogdGhpcy5zZWNsZWN0QWN0aXZlID0gZmFsc2UKICAgIH0sCiAgICBvbkxvYWQoKSB7CiAgICAgIGlmICghdGhpcy5yZWZyZXNoaW5nICYmIHRoaXMucGFnZSA8IHRoaXMudG90YWxQYWdlKSB7CiAgICAgICAgdGhpcy5wYWdlID0gdGhpcy5wYWdlICsgMQogICAgICB9CiAgICAgIGlmICh0aGlzLnJlZnJlc2hpbmcpIHsKICAgICAgICB0aGlzLnByb2R1Y3RMaXN0ID0gW107CiAgICAgICAgdGhpcy5yZWZyZXNoaW5nID0gZmFsc2U7CiAgICAgIH0KICAgICAgdGhpcy5pbml0KCkKICAgIH0sCiAgICBvblJlZnJlc2goKSB7CiAgICAgIHRoaXMucmVmcmVzaGluZyA9IHRydWUKICAgICAgdGhpcy5maW5pc2hlZCA9IGZhbHNlCiAgICAgIHRoaXMubG9hZGluZyA9IHRydWUKICAgICAgdGhpcy5wYWdlID0gMQogICAgICB0aGlzLm9uTG9hZCgpCiAgICB9LAogICAgY2hhbmdlVGFiKG5hbWUsIHRpdGxlKSB7CiAgICAgIHRoaXMub3JkZXJCeSA9IG5hbWUKICAgICAgdGhpcy5vblJlZnJlc2goKQogICAgfQogIH0KfQo="},{"version":3,"sources":["ProductList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ProductList.vue","sourceRoot":"src/views","sourcesContent":["<!--\n * 严肃声明：\n * 开源版本请务必保留此注释头信息，若删除我方将保留所有法律责任追究！\n * 本系统已申请软件著作权，受国家版权局知识产权以及国家计算机软件著作权保护！\n * 可正常分享和学习源码，不得用于违法犯罪活动，违者必究！\n * Copyright (c) 2020 陈尼克 all rights reserved.\n * 版权所有，侵权必究！\n *\n-->\n\n<template>\n  <div class=\"product-list-wrap\">\n    <div class=\"product-list-content\">\n      <header class=\"category-header wrap\">\n        <i class=\"nbicon nbfanhui\" @click=\"goBack\"></i>\n        <div class=\"header-search\">\n          <i class=\"nbicon nbSearch\"></i>\n          <input\n            type=\"text\"\n            class=\"search-title\"\n            @mouseenter=\"textEnter\"\n            @mouseleave=\"textLeave\"\n            v-model=\"keyword\"/>\n        </div>\n        <span class=\"search-btn\" @click=\"getSearch\">搜索</span>\n      </header>\n      <van-tabs type=\"card\" color=\"#1baeae\" @click=\"changeTab\" >\n        <van-tab title=\"推荐\" name=\"\"></van-tab>\n        <van-tab title=\"新品\" name=\"new\"></van-tab>\n        <van-tab title=\"价格\" name=\"price\"></van-tab>\n      </van-tabs>\n    </div>\n    <van-pull-refresh v-model=\"refreshing\" @refresh=\"onRefresh\" class=\"product-list-refresh\">\n      <van-list\n        v-model=\"loading\"\n        :finished=\"finished\"\n        finished-text=\"没有更多了\"\n        @load=\"onLoad\"\n        @offset=\"300\"\n      >\n        <!-- <p v-for=\"item in list\" :key=\"item\">{{ item }}</p> -->\n        <div class=\"product-item\" v-for=\"(item, index) in productList\" :key=\"index\" @click=\"productDetail(item)\">\n          <img :src=\"`//api.newbee.ltd${item.goodsCoverImg}`\" />\n          <div class=\"product-info\">\n            <p class=\"name\">{{item.goodsName}}</p>\n            <p class=\"subtitle\">{{item.goodsIntro}}</p>\n            <span class=\"price\">￥ {{item.sellingPrice}}</span>\n          </div>\n        </div>\n      </van-list>\n    </van-pull-refresh>\n  </div>\n</template>\n\n<script>\nimport { getQueryString } from '@/common/js/utils'\nimport { search } from '../service/good'\nimport { Toast } from 'vant'\nexport default {\n  data() {\n    return {\n      keyword: this.$route.query.keyword || '',\n      searchBtn: false,\n      seclectActive: false,\n      refreshing: false,\n      list: [],\n      loading: false,\n      finished: false,\n      productList: [],\n      totalPage: 0,\n      page: 1,\n      orderBy: ''\n    }\n  },\n  mounted() {\n    // window.addEventListener('scroll', this.pageScroll)\n    // setTimeout(() => {\n    //     this.isLoading = false\n    // }, 500)\n    // this.init()\n  },\n  methods: {\n    async init() {\n      const { categoryId, from } = this.$route.query\n      if (!categoryId && !this.keyword) {\n        // Toast.fail('请输入关键词')\n        this.finished = true\n        this.loading = false;\n        return\n      }\n      const { data, data: { list } } = await search({ pageNumber: this.page, goodsCategoryId: categoryId, keyword: this.keyword, orderBy: this.orderBy })\n      this.productList = this.productList.concat(list)\n      this.totalPage = data.totalPage\n      this.loading = false;\n      if (this.page >= data.totalPage) this.finished = true\n    },\n    goBack() {\n      this.$router.go(-1)\n    },\n    productDetail(item) {\n      this.$router.push({ path: `product/${item.goodsId}` })\n    },\n    textEnter() {\n\n    },\n    textLeave() {\n\n    },\n    getSearch() {\n      this.onRefresh()\n    },\n    pageScroll() {\n      let scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop\n      scrollTop > 50 ? this.seclectActive = true : this.seclectActive = false\n    },\n    onLoad() {\n      if (!this.refreshing && this.page < this.totalPage) {\n        this.page = this.page + 1\n      }\n      if (this.refreshing) {\n        this.productList = [];\n        this.refreshing = false;\n      }\n      this.init()\n    },\n    onRefresh() {\n      this.refreshing = true\n      this.finished = false\n      this.loading = true\n      this.page = 1\n      this.onLoad()\n    },\n    changeTab(name, title) {\n      this.orderBy = name\n      this.onRefresh()\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n  @import '../common/style/mixin';\n  .product-list-content {\n    position: fixed;\n    left: 0;\n    top: 0;\n    width: 100%;\n    z-index: 1000;\n    background: #fff;\n    .category-header {\n      .fj();\n      width: 100%;\n      height: 50px;\n      line-height: 50px;\n      padding: 0 15px;\n      .boxSizing();\n      font-size: 15px;\n      color: #656771;\n      z-index: 10000;\n      &.active {\n        background: @primary;\n      }\n      .icon-left {\n        font-size: 25px;\n        font-weight: bold;\n      }\n      .header-search {\n        display: flex;\n        width: 76%;\n        height: 20px;\n        line-height: 20px;\n        margin: 10px 0;\n        padding: 5px 0;\n        color: #232326;\n        background: #F7F7F7;\n        .borderRadius(20px);\n        .nbSearch {\n          padding: 0 5px 0 20px;\n          font-size: 17px;\n        }\n        .search-title {\n          font-size: 12px;\n          color: #666;\n          background: #F7F7F7;\n        }\n    }\n    .icon-More {\n      font-size: 20px;\n    }\n    .search-btn {\n      height: 28px;\n      margin: 8px 0;\n      line-height: 28px;\n      padding: 0 5px;\n      color: #fff;\n      background: @primary;\n      .borderRadius(5px);\n      margin-top: 10px;\n    }\n  }\n}\n  .product-list-refresh {\n    margin-top: 78px;\n    .product-item {\n      .fj();\n      width: 100%;\n      height: 120px;\n      padding: 10px 0;\n      border-bottom: 1px solid #dcdcdc;\n      img {\n        width: 140px;\n        height: 120px;\n        padding: 0 10px;\n        .boxSizing();\n      }\n      .product-info {\n          width: 56%;\n          height: 120px;\n          padding: 5px;\n          text-align: left;\n          .boxSizing();\n          p {\n            margin: 0\n          }\n          .name {\n            width: 100%;\n            max-height: 40px;\n            line-height: 20px;\n            font-size: 15px;\n            color: #333;\n            overflow: hidden;\n            text-overflow:ellipsis;\n            white-space: nowrap;\n          }\n          .subtitle {\n            width: 100%;\n            max-height: 20px;\n            padding: 10px 0;\n            line-height: 25px;\n            font-size: 13px;\n            color: #999;\n            overflow: hidden;\n          }\n          .price {\n            color: @primary;\n            font-size: 16px;\n          }\n      }\n  }\n}\n</style>\n"]}]}