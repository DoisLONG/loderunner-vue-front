{"remainingRequest":"/Users/daocloud_j/git/loderunner-vue-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/daocloud_j/git/loderunner-vue-front/src/views/Cart.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"/Users/daocloud_j/git/loderunner-vue-front/src/views/Cart.vue","mtime":1591819548000},{"path":"/Users/daocloud_j/git/loderunner-vue-front/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/daocloud_j/git/loderunner-vue-front/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/daocloud_j/git/loderunner-vue-front/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/daocloud_j/git/loderunner-vue-front/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/daocloud_j/git/loderunner-vue-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/daocloud_j/git/loderunner-vue-front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKQGltcG9ydCAnLi4vY29tbW9uL3N0eWxlL21peGluJzsKLmNhcnQtYm94IHsKICAuY2FydC1oZWFkZXIgewogICAgcG9zaXRpb246IGZpeGVkOwogICAgdG9wOiAwOwogICAgbGVmdDogMDsKICAgIHotaW5kZXg6IDEwMDAwOwogICAgLmZqKCk7CiAgICAud2goMTAwJSwgNDRweCk7CiAgICBsaW5lLWhlaWdodDogNDRweDsKICAgIHBhZGRpbmc6IDAgMTBweDsKICAgIC5ib3hTaXppbmcoKTsKICAgIGNvbG9yOiAjMjUyNTI1OwogICAgYmFja2dyb3VuZDogI2ZmZjsKICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZGNkY2RjOwogICAgLmNhcnQtbmFtZSB7CiAgICAgIGZvbnQtc2l6ZTogMTRweDsKICAgIH0KICB9CiAgLmNhcnQtYm9keSB7CiAgICBtYXJnaW46IDYwcHggMCAxMDBweCAwOwogICAgcGFkZGluZy1sZWZ0OiAxMHB4OwogICAgLmdvb2QtaXRlbSB7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIC5nb29kLWltZyB7CiAgICAgICAgaW1nIHsKICAgICAgICAgIC53aCgxMDBweCwgMTAwcHgpCiAgICAgICAgfQogICAgICB9CiAgICAgIC5nb29kLWRlc2MgewogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47CiAgICAgICAgZmxleDogMTsKICAgICAgICBwYWRkaW5nOiAyMHB4OwogICAgICAgIC5nb29kLXRpdGxlIHsKICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47CiAgICAgICAgfQogICAgICAgIC5nb29kLWJ0biB7CiAgICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgICAgICAgLnByaWNlIHsKICAgICAgICAgICAgZm9udC1zaXplOiAxNnB4OwogICAgICAgICAgICBjb2xvcjogcmVkOwogICAgICAgICAgICBsaW5lLWhlaWdodDogMjhweDsKICAgICAgICAgIH0KICAgICAgICAgIC52YW4taWNvbi1kZWxldGUgewogICAgICAgICAgICBmb250LXNpemU6IDIwcHg7CiAgICAgICAgICAgIG1hcmdpbi10b3A6IDRweDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC5kZWxldGUtYnV0dG9uIHsKICAgICAgd2lkdGg6IDUwcHg7CiAgICAgIGhlaWdodDogMTAwJTsKICAgIH0KICB9CiAgLmVtcHR5IHsKICAgIHdpZHRoOiA1MCU7CiAgICBtYXJnaW46IDAgYXV0bzsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgIG1hcmdpbi10b3A6IDIwMHB4OwogICAgLnZhbi1pY29uLXNtaWxlLW8gewogICAgICBmb250LXNpemU6IDUwcHg7CiAgICB9CiAgICAudGl0bGUgewogICAgICBmb250LXNpemU6IDE2cHg7CiAgICAgIG1hcmdpbi1ib3R0b206IDIwcHg7CiAgICB9CiAgfQogIC5zdWJtaXQtYWxsIHsKICAgIG1hcmdpbi1ib3R0b206IDUwcHg7CiAgICAudmFuLWNoZWNrYm94IHsKICAgICAgbWFyZ2luLWxlZnQ6IDEwcHgKICAgIH0KICAgIC52YW4tc3VibWl0LWJhcl9fdGV4dCB7CiAgICAgIG1hcmdpbi1yaWdodDogMTBweAogICAgfQogICAgLnZhbi1zdWJtaXQtYmFyX19idXR0b24gewogICAgICBiYWNrZ3JvdW5kOiBAcHJpbWFyeTsKICAgIH0KICB9CiAgLnZhbi1jaGVja2JveF9faWNvbi0tY2hlY2tlZCAudmFuLWljb24gewogICAgYmFja2dyb3VuZC1jb2xvcjogQHByaW1hcnk7CiAgICBib3JkZXItY29sb3I6IEBwcmltYXJ5OwogIH0KfQo="},{"version":3,"sources":["Cart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Cart.vue","sourceRoot":"src/views","sourcesContent":["<!--\n * 严肃声明：\n * 开源版本请务必保留此注释头信息，若删除我方将保留所有法律责任追究！\n * 本系统已申请软件著作权，受国家版权局知识产权以及国家计算机软件著作权保护！\n * 可正常分享和学习源码，不得用于违法犯罪活动，违者必究！\n * Copyright (c) 2020 陈尼克 all rights reserved.\n * 版权所有，侵权必究！\n *\n-->\n\n<template>\n  <div class=\"cart-box\">\n    <s-header :name=\"'购物车'\"></s-header>\n    <div class=\"cart-body\">\n      <van-checkbox-group @change=\"groupChange\" v-model=\"result\" ref=\"checkboxGroup\">\n        <van-swipe-cell :right-width=\"50\" v-for=\"(item, index) in list\" :key=\"index\">\n          <div class=\"good-item\">\n            <van-checkbox :name=\"item.cartItemId\" />\n            <div class=\"good-img\"><img :src=\"`//api.newbee.ltd${item.goodsCoverImg}`\" alt=\"\"></div>\n            <div class=\"good-desc\">\n              <div class=\"good-title\">\n                <span>{{ item.goodsName }}</span>\n                <span>x{{ item.goodsCount }}</span>\n              </div>\n              <div class=\"good-btn\">\n                <div class=\"price\">¥{{ item.sellingPrice }}</div>\n                <van-stepper\n                  integer\n                  :min=\"1\"\n                  :value=\"item.goodsCount\"\n                  :name=\"item.cartItemId\"\n                  async-change\n                  @change=\"onChange\"\n                />\n              </div>\n            </div>\n          </div>\n          <van-button\n            slot=\"right\"\n            square\n            icon=\"delete\"\n            type=\"danger\"\n            class=\"delete-button\"\n            @click=\"deleteGood(item.cartItemId)\"\n          />\n        </van-swipe-cell>\n      </van-checkbox-group>\n    </div>\n    <van-submit-bar\n      v-if=\"list.length > 0\"\n      class=\"submit-all\"\n      :price=\"total * 100\"\n      button-text=\"结算\"\n      @submit=\"onSubmit\"\n    >\n      <van-checkbox @click=\"allCheck\" v-model=\"checkAll\">全选</van-checkbox>\n    </van-submit-bar>\n    <div class=\"empty\" v-if=\"!list.length\">\n      <van-icon name=\"smile-o\" />\n      <div class=\"title\">购物车空空空如也</div>\n      <van-button color=\"#1baeae\" type=\"primary\" @click=\"goTo\" block>前往首页</van-button>\n    </div>\n    <nav-bar></nav-bar>\n  </div>\n</template>\n\n<script>\nimport { Toast } from 'vant'\nimport navBar from '@/components/NavBar'\nimport sHeader from '@/components/SimpleHeader'\nimport { getCart, deleteCartItem, modifyCart } from '../service/cart'\nexport default {\n  data() {\n    return {\n      checked: false,\n      list: [],\n      all: false,\n      result: [],\n      checkAll: true\n    }\n  },\n  components: {\n    navBar,\n    sHeader\n  },\n  mounted() {\n    this.init()\n  },\n  computed: {\n    total: function() {\n      let sum = 0\n      let _list = this.list.filter(item => this.result.includes(item.cartItemId))\n      _list.forEach(item => {\n        sum += item.goodsCount * item.sellingPrice\n      })\n      return sum\n    }\n  },\n  methods: {\n    async init() {\n      Toast.loading({ message: '加载中...', forbidClick: true });\n      const { data } = await getCart({ pageNumber: 1 })\n      this.list = data\n      this.result = data.map(item => item.cartItemId)\n      Toast.clear()\n    },\n    goBack() {\n      this.$router.go(-1)\n    },\n    goTo() {\n      this.$router.push({ path: 'home' })\n    },\n    async onChange(value, detail) {\n      if (this.list.filter(item => item.cartItemId == detail.name)[0].goodsCount == value) return\n      Toast.loading({ message: '修改中...', forbidClick: true });\n      const params = {\n        cartItemId: detail.name,\n        goodsCount: value\n      }\n      const { data } = await modifyCart(params)\n      this.list.forEach(item => {\n        if (item.cartItemId == detail.name) {\n          item.goodsCount = value\n        }\n      })\n      Toast.clear();\n    },\n    async onSubmit() {\n      const params = JSON.stringify(this.result)\n      // for(let i = 0; i < this.result.length; i++) {\n      //   await deleteCartItem(this.result[i])\n      // }\n      this.$router.push({ path: `create-order?cartItemIds=${params}` })\n    },\n    async deleteGood(id) {\n      const { data } = await deleteCartItem(id)\n      this.$store.dispatch('updateCart')\n      this.init()\n    },\n    groupChange(result) {\n      if (result.length == this.list.length) {\n        this.checkAll = true\n      } else {\n        this.checkAll = false\n      }\n      this.result = result\n    },\n    allCheck(value) {\n      if (!this.checkAll) {\n        this.result = this.list.map(item => item.cartItemId)\n      } else {\n        this.result = []\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"less\">\n  @import '../common/style/mixin';\n  .cart-box {\n    .cart-header {\n      position: fixed;\n      top: 0;\n      left: 0;\n      z-index: 10000;\n      .fj();\n      .wh(100%, 44px);\n      line-height: 44px;\n      padding: 0 10px;\n      .boxSizing();\n      color: #252525;\n      background: #fff;\n      border-bottom: 1px solid #dcdcdc;\n      .cart-name {\n        font-size: 14px;\n      }\n    }\n    .cart-body {\n      margin: 60px 0 100px 0;\n      padding-left: 10px;\n      .good-item {\n        display: flex;\n        .good-img {\n          img {\n            .wh(100px, 100px)\n          }\n        }\n        .good-desc {\n          display: flex;\n          flex-direction: column;\n          justify-content: space-between;\n          flex: 1;\n          padding: 20px;\n          .good-title {\n            display: flex;\n            justify-content: space-between;\n          }\n          .good-btn {\n            display: flex;\n            justify-content: space-between;\n            .price {\n              font-size: 16px;\n              color: red;\n              line-height: 28px;\n            }\n            .van-icon-delete {\n              font-size: 20px;\n              margin-top: 4px;\n            }\n          }\n        }\n      }\n      .delete-button {\n        width: 50px;\n        height: 100%;\n      }\n    }\n    .empty {\n      width: 50%;\n      margin: 0 auto;\n      text-align: center;\n      margin-top: 200px;\n      .van-icon-smile-o {\n        font-size: 50px;\n      }\n      .title {\n        font-size: 16px;\n        margin-bottom: 20px;\n      }\n    }\n    .submit-all {\n      margin-bottom: 50px;\n      .van-checkbox {\n        margin-left: 10px\n      }\n      .van-submit-bar__text {\n        margin-right: 10px\n      }\n      .van-submit-bar__button {\n        background: @primary;\n      }\n    }\n    .van-checkbox__icon--checked .van-icon {\n      background-color: @primary;\n      border-color: @primary;\n    }\n  }\n</style>\n"]}]}