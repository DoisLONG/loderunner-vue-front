{"remainingRequest":"/Users/daocloud_j/git/loderunner-vue-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/daocloud_j/git/loderunner-vue-front/src/views/AddressEdit.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/daocloud_j/git/loderunner-vue-front/src/views/AddressEdit.vue","mtime":1591819548000},{"path":"/Users/daocloud_j/git/loderunner-vue-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/daocloud_j/git/loderunner-vue-front/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/daocloud_j/git/loderunner-vue-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/daocloud_j/git/loderunner-vue-front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IFRvYXN0IH0gZnJvbSAndmFudCcKaW1wb3J0IHNIZWFkZXIgZnJvbSAnQC9jb21wb25lbnRzL1NpbXBsZUhlYWRlcicKaW1wb3J0IHsgYWRkQWRkcmVzcywgRWRpdEFkZHJlc3MsIERlbGV0ZUFkZHJlc3MsIGdldEFkZHJlc3NEZXRhaWwgfSBmcm9tICcuLi9zZXJ2aWNlL2FkZHJlc3MnCmltcG9ydCB7IHRkaXN0IH0gZnJvbSAnQC9jb21tb24vanMvdXRpbHMnCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBzSGVhZGVyCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgYXJlYUxpc3Q6IHsKICAgICAgICBwcm92aW5jZV9saXN0OiB7fSwKICAgICAgICBjaXR5X2xpc3Q6IHt9LAogICAgICAgIGNvdW50eV9saXN0OiB7fQogICAgICB9LAogICAgICBzZWFyY2hSZXN1bHQ6IFtdLAogICAgICB0eXBlOiAnYWRkJywKICAgICAgYWRkcmVzc0lkOiAnJywKICAgICAgYWRkcmVzc0luZm86IHt9LAogICAgICBmcm9tOiAnJwogICAgfQogIH0sCiAgYXN5bmMgbW91bnRlZCgpIHsKICAgIC8vIOecgeW4guWMuuWIl+ihqOaehOmAoAogICAgbGV0IF9wcm92aW5jZV9saXN0ID0ge30KICAgIGxldCBfY2l0eV9saXN0ID0ge30KICAgIGxldCBfY291bnR5X2xpc3QgPSB7fQogICAgdGRpc3QuZ2V0TGV2MSgpLmZvckVhY2gocCA9PiB7CiAgICAgIF9wcm92aW5jZV9saXN0W3AuaWRdID0gcC50ZXh0CiAgICAgIHRkaXN0LmdldExldjIocC5pZCkuZm9yRWFjaChjID0+IHsKICAgICAgICBfY2l0eV9saXN0W2MuaWRdID0gYy50ZXh0CiAgICAgICAgdGRpc3QuZ2V0TGV2MyhjLmlkKS5mb3JFYWNoKHEgPT4gX2NvdW50eV9saXN0W3EuaWRdID0gcS50ZXh0KQogICAgICB9KQogICAgfSkKICAgIHRoaXMuYXJlYUxpc3QucHJvdmluY2VfbGlzdCA9IF9wcm92aW5jZV9saXN0CiAgICB0aGlzLmFyZWFMaXN0LmNpdHlfbGlzdCA9IF9jaXR5X2xpc3QKICAgIHRoaXMuYXJlYUxpc3QuY291bnR5X2xpc3QgPSBfY291bnR5X2xpc3QKCiAgICBjb25zdCB7IGFkZHJlc3NJZCwgdHlwZSwgZnJvbSB9ID0gdGhpcy4kcm91dGUucXVlcnkKICAgIHRoaXMuYWRkcmVzc0lkID0gYWRkcmVzc0lkCiAgICB0aGlzLnR5cGUgPSB0eXBlCiAgICB0aGlzLmZyb20gPSBmcm9tIHx8ICcnCiAgICBpZiAodHlwZSA9PSAnZWRpdCcpIHsKICAgICAgY29uc3QgeyBkYXRhOiBhZGRyZXNzRGV0YWlsIH0gPSBhd2FpdCBnZXRBZGRyZXNzRGV0YWlsKGFkZHJlc3NJZCkKICAgICAgbGV0IF9hcmVhQ29kZSA9ICcnCiAgICAgIGNvbnN0IHByb3ZpbmNlID0gdGRpc3QuZ2V0TGV2MSgpCiAgICAgIE9iamVjdC5lbnRyaWVzKHRoaXMuYXJlYUxpc3QuY291bnR5X2xpc3QpLmZvckVhY2goKFtpZCwgdGV4dF0pID0+IHsKICAgICAgICAvLyDlhYjmib7lh7rlvZPliY3lr7nlupTnmoTljLoKICAgICAgICBpZiAodGV4dCA9PSBhZGRyZXNzRGV0YWlsLnJlZ2lvbk5hbWUpIHsKICAgICAgICAgIC8vIOaJvuWIsOWMuuWvueW6lOeahOWHoOS4quecgeS7vQogICAgICAgICAgY29uc3QgcHJvdmluY2VJbmRleCA9IHByb3ZpbmNlLmZpbmRJbmRleChpdGVtID0+IGl0ZW0uaWQuc3Vic3RyKDAsIDIpID09IGlkLnN1YnN0cigwLCAyKSkKICAgICAgICAgIC8vIOaJvuWIsOWMuuWvueW6lOeahOWHoOS4quW4guWMugogICAgICAgICAgY29uc3QgY2l0eUl0ZW0gPSBPYmplY3QuZW50cmllcyh0aGlzLmFyZWFMaXN0LmNpdHlfbGlzdCkuZmlsdGVyKChbY2l0eUlkLCBjaXR5TmFtZV0pID0+IGNpdHlJZC5zdWJzdHIoMCwgNCkgPT0gaWQuc3Vic3RyKDAsIDQpKVswXQogICAgICAgICAgLy8g5a+55q+U5om+5Yiw55qE55yB5Lu95ZKM5o6l5Y+j6L+U5Zue55qE55yB5Lu95piv5ZCm55u4562J77yM5Zug5Li65pyJ5LiA5Lqb5Yy65Lya6YeN5ZCNCiAgICAgICAgICBpZiAocHJvdmluY2VbcHJvdmluY2VJbmRleF0udGV4dCA9PSBhZGRyZXNzRGV0YWlsLnByb3ZpbmNlTmFtZSAmJiBjaXR5SXRlbVsxXSA9PSBhZGRyZXNzRGV0YWlsLmNpdHlOYW1lKSB7CiAgICAgICAgICAgIF9hcmVhQ29kZSA9IGlkCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KQogICAgICB0aGlzLmFkZHJlc3NJbmZvID0gewogICAgICAgIGlkOiBhZGRyZXNzRGV0YWlsLmFkZHJlc3NJZCwKICAgICAgICBuYW1lOiBhZGRyZXNzRGV0YWlsLnVzZXJOYW1lLAogICAgICAgIHRlbDogYWRkcmVzc0RldGFpbC51c2VyUGhvbmUsCiAgICAgICAgcHJvdmluY2U6IGFkZHJlc3NEZXRhaWwucHJvdmluY2VOYW1lLAogICAgICAgIGNpdHk6IGFkZHJlc3NEZXRhaWwuY2l0eU5hbWUsCiAgICAgICAgY291bnR5OiBhZGRyZXNzRGV0YWlsLnJlZ2lvbk5hbWUsCiAgICAgICAgYWRkcmVzc0RldGFpbDogYWRkcmVzc0RldGFpbC5kZXRhaWxBZGRyZXNzLAogICAgICAgIGFyZWFDb2RlOiBfYXJlYUNvZGUsCiAgICAgICAgaXNEZWZhdWx0OiAhIWFkZHJlc3NEZXRhaWwuZGVmYXVsdEZsYWcKICAgICAgfQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgb25TYXZlKGNvbnRlbnQpIHsKICAgICAgY29uc3QgcGFyYW1zID0gewogICAgICAgIHVzZXJOYW1lOiBjb250ZW50Lm5hbWUsCiAgICAgICAgdXNlclBob25lOiBjb250ZW50LnRlbCwKICAgICAgICBwcm92aW5jZU5hbWU6IGNvbnRlbnQucHJvdmluY2UsCiAgICAgICAgY2l0eU5hbWU6IGNvbnRlbnQuY2l0eSwKICAgICAgICByZWdpb25OYW1lOiBjb250ZW50LmNvdW50eSwKICAgICAgICBkZXRhaWxBZGRyZXNzOiBjb250ZW50LmFkZHJlc3NEZXRhaWwsCiAgICAgICAgZGVmYXVsdEZsYWc6IGNvbnRlbnQuaXNEZWZhdWx0ID8gMSA6IDAsCiAgICAgIH0KICAgICAgaWYgKHRoaXMudHlwZSA9PSAnZWRpdCcpIHsKICAgICAgICBwYXJhbXNbJ2FkZHJlc3NJZCddID0gdGhpcy5hZGRyZXNzSWQKICAgICAgfQogICAgICBjb25zdCB7IG1lc3NhZ2UgfSA9IGF3YWl0IHRoaXMudHlwZSA9PSAnYWRkJyA/IGFkZEFkZHJlc3MocGFyYW1zKSA6IEVkaXRBZGRyZXNzKHBhcmFtcykKICAgICAgVG9hc3QoJ+S/neWtmOaIkOWKnycpCiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgcGF0aDogYGFkZHJlc3M/ZnJvbT0ke3RoaXMuZnJvbX1gIH0pCiAgICAgIH0sIDEwMDApCgogICAgfSwKICAgIGFzeW5jIG9uRGVsZXRlKCkgewogICAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IERlbGV0ZUFkZHJlc3ModGhpcy5hZGRyZXNzSWQpCiAgICAgIFRvYXN0KCfliKDpmaTmiJDlip8nKQogICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IHBhdGg6ICdhZGRyZXNzJyB9KQogICAgICB9LCAxMDAwKQogICAgfQogIH0KfQo="},{"version":3,"sources":["AddressEdit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AddressEdit.vue","sourceRoot":"src/views","sourcesContent":["<!--\n * 严肃声明：\n * 开源版本请务必保留此注释头信息，若删除我方将保留所有法律责任追究！\n * 本系统已申请软件著作权，受国家版权局知识产权以及国家计算机软件著作权保护！\n * 可正常分享和学习源码，不得用于违法犯罪活动，违者必究！\n * Copyright (c) 2020 陈尼克 all rights reserved.\n * 版权所有，侵权必究！\n *\n-->\n\n<template>\n  <div class=\"address-edit-box\">\n    <s-header :name=\"`${type == 'add' ? '新增地址' : '编辑地址'}`\"></s-header>\n    <van-address-edit\n      class=\"edit\"\n      :area-list=\"areaList\"\n      :address-info=\"addressInfo\"\n      :show-delete=\"type == 'edit'\"\n      show-set-default\n      show-search-result\n      :search-result=\"searchResult\"\n      :area-columns-placeholder=\"['请选择', '请选择', '请选择']\"\n      @save=\"onSave\"\n      @delete=\"onDelete\"\n    />\n  </div>\n</template>\n\n<script>\nimport { Toast } from 'vant'\nimport sHeader from '@/components/SimpleHeader'\nimport { addAddress, EditAddress, DeleteAddress, getAddressDetail } from '../service/address'\nimport { tdist } from '@/common/js/utils'\nexport default {\n  components: {\n    sHeader\n  },\n  data() {\n    return {\n      areaList: {\n        province_list: {},\n        city_list: {},\n        county_list: {}\n      },\n      searchResult: [],\n      type: 'add',\n      addressId: '',\n      addressInfo: {},\n      from: ''\n    }\n  },\n  async mounted() {\n    // 省市区列表构造\n    let _province_list = {}\n    let _city_list = {}\n    let _county_list = {}\n    tdist.getLev1().forEach(p => {\n      _province_list[p.id] = p.text\n      tdist.getLev2(p.id).forEach(c => {\n        _city_list[c.id] = c.text\n        tdist.getLev3(c.id).forEach(q => _county_list[q.id] = q.text)\n      })\n    })\n    this.areaList.province_list = _province_list\n    this.areaList.city_list = _city_list\n    this.areaList.county_list = _county_list\n\n    const { addressId, type, from } = this.$route.query\n    this.addressId = addressId\n    this.type = type\n    this.from = from || ''\n    if (type == 'edit') {\n      const { data: addressDetail } = await getAddressDetail(addressId)\n      let _areaCode = ''\n      const province = tdist.getLev1()\n      Object.entries(this.areaList.county_list).forEach(([id, text]) => {\n        // 先找出当前对应的区\n        if (text == addressDetail.regionName) {\n          // 找到区对应的几个省份\n          const provinceIndex = province.findIndex(item => item.id.substr(0, 2) == id.substr(0, 2))\n          // 找到区对应的几个市区\n          const cityItem = Object.entries(this.areaList.city_list).filter(([cityId, cityName]) => cityId.substr(0, 4) == id.substr(0, 4))[0]\n          // 对比找到的省份和接口返回的省份是否相等，因为有一些区会重名\n          if (province[provinceIndex].text == addressDetail.provinceName && cityItem[1] == addressDetail.cityName) {\n            _areaCode = id\n          }\n        }\n      })\n      this.addressInfo = {\n        id: addressDetail.addressId,\n        name: addressDetail.userName,\n        tel: addressDetail.userPhone,\n        province: addressDetail.provinceName,\n        city: addressDetail.cityName,\n        county: addressDetail.regionName,\n        addressDetail: addressDetail.detailAddress,\n        areaCode: _areaCode,\n        isDefault: !!addressDetail.defaultFlag\n      }\n    }\n  },\n  methods: {\n    async onSave(content) {\n      const params = {\n        userName: content.name,\n        userPhone: content.tel,\n        provinceName: content.province,\n        cityName: content.city,\n        regionName: content.county,\n        detailAddress: content.addressDetail,\n        defaultFlag: content.isDefault ? 1 : 0,\n      }\n      if (this.type == 'edit') {\n        params['addressId'] = this.addressId\n      }\n      const { message } = await this.type == 'add' ? addAddress(params) : EditAddress(params)\n      Toast('保存成功')\n      setTimeout(() => {\n        this.$router.push({ path: `address?from=${this.from}` })\n      }, 1000)\n\n    },\n    async onDelete() {\n      const { data } = await DeleteAddress(this.addressId)\n      Toast('删除成功')\n      setTimeout(() => {\n        this.$router.push({ path: 'address' })\n      }, 1000)\n    }\n  }\n}\n</script>\n\n<style lang=\"less\">\n  @import '../common/style/mixin';\n  .address-edit-box {\n    margin-top: 44px;\n    .van-address-edit {\n      .van-button--danger {\n        background: @primary;\n        border-color: @primary;\n      }\n      .van-switch--on {\n        background: @primary;\n      }\n    }\n  }\n</style>\n"]}]}